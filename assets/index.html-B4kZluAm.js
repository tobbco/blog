import{_ as i,c as a,a as e,o as t}from"./app-DLwuheDP.js";const n={};function l(d,s){return t(),a("div",null,s[0]||(s[0]=[e(`<h2 id="准备" tabindex="-1"><a class="header-anchor" href="#准备"><span>准备</span></a></h2><p>是否已安装<code>docker</code></p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -v</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>如未安装需要先安装<code>docker</code>，参考官方<a href="https://docs.docker.com/get-started/get-docker/" target="_blank" rel="noopener noreferrer">Get Docker | Docker Docs</a></p><h2 id="docker部署" tabindex="-1"><a class="header-anchor" href="#docker部署"><span>Docker部署</span></a></h2><h3 id="部署容器" tabindex="-1"><a class="header-anchor" href="#部署容器"><span>部署容器</span></a></h3><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> run</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -d</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -p</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 5672:5672</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -p</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> 15672:15672</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">--name </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">rabbitmq-dev</span></span>
<span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">-v</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> /usr/local/docker/rabbitmq:/var/lib/rabbitmq</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">-e </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">RABBITMQ_DEFAULT_USER=admin</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">-e </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">RABBITMQ_DEFAULT_PASS=admin</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;">  \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">-e </span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">RABBITMQ_DEFAULT_VHOST=custom-vhost</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> \\</span></span>
<span class="line"><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">rabbitmq:management</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="命令解释" tabindex="-1"><a class="header-anchor" href="#命令解释"><span>命令解释</span></a></h3><ul><li><code>-id</code>：以交互模式启动容器并在后台运行。</li><li><code>--name=rabbitmq-dev</code>：为容器指定一个名称。</li><li><code>-v /usr/local/docker/rabbitmq:/var/lib/rabbitmq</code>：将主机目录挂载到容器内的 <code>/var/lib/rabbitmq</code>，用于持久化数据。</li><li><code>-p 15672:15672</code>：映射 RabbitMQ 管理页面端口。</li><li><code>-p 5672:5672</code>：映射 RabbitMQ 消息接收端口。</li><li><code>-e RABBITMQ_DEFAULT_USER=admin</code>：设置默认用户名。</li><li><code>-e RABBITMQ_DEFAULT_PASS=admin</code>：设置默认密码。</li><li><code>-e RABBITMQ_DEFAULT_VHOST</code>：虚拟主机</li></ul><h3 id="查看启动日志" tabindex="-1"><a class="header-anchor" href="#查看启动日志"><span>查看启动日志</span></a></h3><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> logs</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -f</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rabbitmq-dev</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="验证" tabindex="-1"><a class="header-anchor" href="#验证"><span>验证</span></a></h3><p>浏览器访问：<code>http://&lt;你的服务器地址&gt;:15672</code>，到达<code>RabbitMQ</code> 管理界面，输入前面设置的默认用户名密码进行登录。</p><h2 id="添加延时队列插件" tabindex="-1"><a class="header-anchor" href="#添加延时队列插件"><span>添加延时队列插件</span></a></h2><p>当需要延时队列时，需要额外添加插件<code>rabbitmq_delayed_message_exchange</code></p><h4 id="查看rabbitmq版本" tabindex="-1"><a class="header-anchor" href="#查看rabbitmq版本"><span>查看<code>rabbitmq</code>版本</span></a></h4><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> inspect</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rabbitmq:management</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><blockquote><p>查看Env下的RABBITMQ_VERSION内容，然后去下载对应版本的插件</p></blockquote><h3 id="下载插件" tabindex="-1"><a class="header-anchor" href="#下载插件"><span>下载插件</span></a></h3><p>插件地址 <a href="https://www.rabbitmq.com/community-plugins" target="_blank" rel="noopener noreferrer">Community Plugins | RabbitMQ</a></p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">wget</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> https://github.com/rabbitmq/rabbitmq-delayed-message-exchange/releases/download/v3.13.0/rabbitmq_delayed_message_exchange-3.13.0.ez</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="将插件拷贝到容器内" tabindex="-1"><a class="header-anchor" href="#将插件拷贝到容器内"><span>将插件拷贝到容器内</span></a></h3><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> cp</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> ./rabbitmq_delayed_message_exchange-3.13.0.ez</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">你的容器I</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">D</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">:/plugins</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="启用插件" tabindex="-1"><a class="header-anchor" href="#启用插件"><span>启用插件</span></a></h3><p>进入容器</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">sudo</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> exec</span><span style="--shiki-light:#A65E2B;--shiki-dark:#C99076;"> -it</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> &lt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;">你的容器I</span><span style="--shiki-light:#393A34;--shiki-dark:#DBD7CAEE;">D</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;">&gt;</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> bash</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="查看是否已安装插件" tabindex="-1"><a class="header-anchor" href="#查看是否已安装插件"><span>查看是否已安装插件</span></a></h3><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#998418;--shiki-dark:#B8A965;">cd</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> plugins</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">ls</span><span style="--shiki-light:#AB5959;--shiki-dark:#CB7676;"> |</span><span style="--shiki-light:#59873A;--shiki-dark:#80A665;"> grep</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> delay</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>开启插件</p><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">rabbitmq-plugins</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> enable</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rabbitmq_delayed_message_exchange</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="重启rabbitmq" tabindex="-1"><a class="header-anchor" href="#重启rabbitmq"><span>重启RabbitMQ</span></a></h3><div class="language-bash line-numbers-mode" data-ext="bash" data-title="bash"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki shiki-themes vitesse-light vitesse-dark vp-code"><code><span class="line"><span style="--shiki-light:#59873A;--shiki-dark:#80A665;">docker</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> restart</span><span style="--shiki-light:#B56959;--shiki-dark:#C98A7D;"> rabbitmq-dev</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h3 id="验证-1" tabindex="-1"><a class="header-anchor" href="#验证-1"><span>验证</span></a></h3><p>容器启动成功之后，登录<code>RabbitMQ</code>的管理界面（<code>IP:15672</code> 访问web界面），找到ExchangesTab页。点击<code>Add a new exchange</code>，在Type里面查看是否有<code>x-delayed-message</code>选项，如果存在就代表插件安装成功。</p><h2 id="插件问题" tabindex="-1"><a class="header-anchor" href="#插件问题"><span>插件问题</span></a></h2><p>在使用 RabbitMQ 时，可能会遇到一些常见问题。以下是一些排查方法：</p><ul><li>无法访问管理界面：检查 <code>15672 </code>端口是否开放，确保防火墙未阻止该端口。</li><li>消息堆积：检查消费者是否正常工作，确保消息被及时处理。</li><li>内存不足：调整 <code>vm_memory_high_watermark</code> 参数，增加内存限制。</li></ul>`,38)]))}const r=i(n,[["render",l],["__file","index.html.vue"]]),p=JSON.parse('{"path":"/article/8qafx2le/","title":"Docker部署单机RobbitMQ","lang":"zh-CN","frontmatter":{"pageLayout":"doc","title":"Docker部署单机RobbitMQ","createTime":"2024/11/16 11:41:25","cover":null,"tags":["中间件","消息队列","MQ","RabbitMQ"],"permalink":"/article/8qafx2le/"},"headers":[],"readingTime":{"minutes":1.87,"words":560},"git":{"updatedTime":1737015927000,"contributors":[{"name":"xianchaoye","username":"xianchaoye","email":"18201082822@163.com","commits":1,"avatar":"https://avatars.githubusercontent.com/xianchaoye?v=4","url":"https://github.com/xianchaoye"}]},"filePathRelative":"docker/Docker部署单机RabbitMQ.md","categoryList":[{"id":"05b605","sort":10008,"name":"docker"}],"bulletin":false}');export{r as comp,p as data};
